✅ Loaded label dictionary with 124 anatomical structures
Project Root: /home/hpadmin/NV
DICOM Source: /home/hpadmin/NV/dicom
NIFTI Destination: /home/hpadmin/NV/outputs/nifti
--------------------------------------------------
Found 5 DICOM directories to process
Progress bar will show below:
--------------------------------------------------
🔄 Overwriting existing directory: /home/hpadmin/NV/outputs/nifti/PA00000002

Processing: PA00000002
----------
Saving NIFTI files into directory /home/hpadmin/NV/outputs/nifti/PA00000002
📊 Found 390 valid DICOM files
🔍 Detected 6 different series

  Processing series 1/6: 2.5MM ARTERIAL_Series3_6.6 CTA ABDOMEN PELVIS SINGLE PHASE_2.500000mm
    Analyzing 146 slices with enhanced quality...
🔧 DICOM rescale parameters:
   Slope: 1.0
   Intercept: -1024.0
   Window Center: 40.0
   Window Width: 400.0
    🔍 Enhanced slice ordering:
       Method: position_z
       Total slices: 146
       Validation: excellent
    ✅ Enhanced processing completed
    📊 Volume specifications:
       Width: 512 pixels
       Height: 512 pixels
       Slices: 146
       Total voxels: 38,273,024
    🔄 Creating 3D volume...
    ✅ Successfully processed 146/146 slices
    🔧 Optimizing to int16 (-32768 to 32767)
    ℹ️  Current data type is already optimal
   DEBUG: ImageOrientationPatient: [1.0, 0.0, 0.0, 0.0, 1.0, 0.0]
📐 Enhanced affine matrix created:
   Spacing: 0.703 x 0.703 x 2.500 mm
   Orientation: [1.0, 0.0, 0.0, 0.0, 1.0, 0.0]
   Origin: [-157.9, -173.4, -368.5]
    💾 Successfully created: 01_2.5MM_ARTERIAL.nii.gz
    📊 Final volume: (512, 512, 146)
    📏 Data range: [-2157, 1775]
    💾 File size: 42.7 MB
    📊 Quality Report Generated:
       Data range: [-2157.0, 1775.0]
       Mean: -581.9 ± 829.9
       Voxel spacing: 0.70 x 0.70 x 2.50 mm
       Volume size: 360.0 x 360.0 x 365.0 mm

  Processing series 2/6: CORONAL ABDOMEN_Series601_6.6 CTA ABDOMEN PELVIS SINGLE PHASE_0.625000mm
    Analyzing 1 slices with enhanced quality...
🔧 DICOM rescale parameters:
   Slope: 1.0
   Intercept: -1024.0
   Window Center: 40.0
   Window Width: 400.0
    🔍 Enhanced slice ordering:
       Method: position_z
       Total slices: 1
       Validation: insufficient_slices
       ⚠️  Less than 2 slices found
    ✅ Enhanced processing completed
    📊 Volume specifications:
       Width: 512 pixels
       Height: 512 pixels
       Slices: 1
       Total voxels: 262,144
    🔄 Creating 3D volume...
    ✅ Successfully processed 1/1 slices
    🔧 Optimizing to int16 (-32768 to 32767)
    ℹ️  Current data type is already optimal
   DEBUG: ImageOrientationPatient: [0.0, 1.0, 0.0, 0.0, 0.0, -1.0]
📐 Enhanced affine matrix created:
   Spacing: 0.709 x 0.709 x 0.625 mm
   Orientation: [0.0, 1.0, 0.0, 0.0, 0.0, -1.0]
   Origin: [21.8, -175.0, -6.3]
    💾 Successfully created: 02_CORONAL_ABDOMEN.nii.gz
    📊 Final volume: (512, 512, 1)
    📏 Data range: [-1388, 3314]
    💾 File size: 0.3 MB
    📊 Quality Report Generated:
       Data range: [-1388.0, 3314.0]
       Mean: 174.1 ± 1156.2
       Voxel spacing: 0.71 x 0.71 x 0.62 mm
       Volume size: 363.1 x 363.1 x 0.6 mm

  Processing series 3/6: CORONAL ABDOMEN_Series601_6.6 CTA ABDOMEN PELVIS SINGLE PHASE_2.500000mm
    Analyzing 120 slices with enhanced quality...
🔧 DICOM rescale parameters:
   Slope: 1.0
   Intercept: -1024.0
   Window Center: 40.0
   Window Width: 400.0
    🔍 Enhanced slice ordering:
       Method: position_z
       Total slices: 120
       Validation: excellent
    ✅ Enhanced processing completed
    📊 Volume specifications:
       Width: 512 pixels
       Height: 512 pixels
       Slices: 120
       Total voxels: 31,457,280
    🔄 Creating 3D volume...
    ✅ Successfully processed 120/120 slices
    🔧 Optimizing to int16 (-32768 to 32767)
    ℹ️  Current data type is already optimal
   DEBUG: ImageOrientationPatient: [1.0, 0.0, 0.0, 0.0, 0.0, -1.0]
📐 Enhanced affine matrix created:
   Spacing: 0.709 x 0.709 x 0.189 mm
   Orientation: [1.0, 0.0, 0.0, 0.0, 0.0, -1.0]
   Origin: [-159.8, -7.4, -6.0]
    💾 Successfully created: 03_CORONAL_ABDOMEN.nii.gz
    📊 Final volume: (512, 512, 120)
    📏 Data range: [-1040, 1658]
    💾 File size: 24.9 MB
    📊 Quality Report Generated:
       Data range: [-1040.0, 1658.0]
       Mean: -391.6 ± 497.8
       Voxel spacing: 0.71 x 0.71 x 0.19 mm
       Volume size: 363.1 x 363.1 x 22.7 mm

  Processing series 4/6: SAGITTAL ABDOMEN_Series602_6.6 CTA ABDOMEN PELVIS SINGLE PHASE_0.625000mm
    Analyzing 1 slices with enhanced quality...
🔧 DICOM rescale parameters:
   Slope: 1.0
   Intercept: -1024.0
   Window Center: 40.0
   Window Width: 400.0
    🔍 Enhanced slice ordering:
       Method: position_z
       Total slices: 1
       Validation: insufficient_slices
       ⚠️  Less than 2 slices found
    ✅ Enhanced processing completed
    📊 Volume specifications:
       Width: 512 pixels
       Height: 512 pixels
       Slices: 1
       Total voxels: 262,144
    🔄 Creating 3D volume...
    ✅ Successfully processed 1/1 slices
    🔧 Optimizing to int16 (-32768 to 32767)
    ℹ️  Current data type is already optimal
   DEBUG: ImageOrientationPatient: [1.0, 0.0, 0.0, 0.0, 0.0, -1.0]
📐 Enhanced affine matrix created:
   Spacing: 0.709 x 0.709 x 0.625 mm
   Orientation: [1.0, 0.0, 0.0, 0.0, 0.0, -1.0]
   Origin: [-159.5, 6.3, -6.3]
    💾 Successfully created: 04_SAGITTAL_ABDOMEN.nii.gz
    📊 Final volume: (512, 512, 1)
    📏 Data range: [-1354, 3399]
    💾 File size: 0.3 MB
    📊 Quality Report Generated:
       Data range: [-1354.0, 3399.0]
       Mean: 207.4 ± 1138.8
       Voxel spacing: 0.71 x 0.71 x 0.62 mm
       Volume size: 363.1 x 363.1 x 0.6 mm

  Processing series 5/6: SAGITTAL ABDOMEN_Series602_6.6 CTA ABDOMEN PELVIS SINGLE PHASE_2.500000mm
    Analyzing 120 slices with enhanced quality...
🔧 DICOM rescale parameters:
   Slope: 1.0
   Intercept: -1024.0
   Window Center: 40.0
   Window Width: 400.0
    🔍 Enhanced slice ordering:
       Method: position_z
       Total slices: 120
       Validation: excellent
    ✅ Enhanced processing completed
    📊 Volume specifications:
       Width: 512 pixels
       Height: 512 pixels
       Slices: 120
       Total voxels: 31,457,280
    🔄 Creating 3D volume...
    ✅ Successfully processed 120/120 slices
    🔧 Optimizing to int16 (-32768 to 32767)
    ℹ️  Current data type is already optimal
   DEBUG: ImageOrientationPatient: [0.0, 1.0, 0.0, 0.0, 0.0, -1.0]
📐 Enhanced affine matrix created:
   Spacing: 0.709 x 0.709 x 1.366 mm
   Orientation: [0.0, 1.0, 0.0, 0.0, 0.0, -1.0]
   Origin: [38.1, -175.3, -6.0]
    💾 Successfully created: 05_SAGITTAL_ABDOMEN.nii.gz
    📊 Final volume: (512, 512, 120)
    📏 Data range: [-1046, 1624]
    💾 File size: 25.4 MB
    📊 Quality Report Generated:
       Data range: [-1046.0, 1624.0]
       Mean: -391.6 ± 497.7
       Voxel spacing: 0.71 x 0.71 x 1.37 mm
       Volume size: 363.1 x 363.1 x 163.9 mm

  Processing series 6/6: SCOUT_Series1_6.6 CTA ABDOMEN PELVIS SINGLE PHASE_550.545455mm
    Analyzing 2 slices with enhanced quality...
🔧 DICOM rescale parameters:
   Slope: 1.0
   Intercept: -1024.0
   Window Center: 50.0
   Window Width: 1000.0
    🔍 Enhanced slice ordering:
       Method: position_z
       Total slices: 2
       Validation: excellent
    ✅ Enhanced processing completed
    📊 Volume specifications:
       Width: 888 pixels
       Height: 1009 pixels
       Slices: 2
       Total voxels: 1,791,984
    🔄 Creating 3D volume...
    ✅ Successfully processed 2/2 slices
    🔧 Optimizing to int16 (-32768 to 32767)
    ℹ️  Current data type is already optimal
   DEBUG: ImageOrientationPatient: [1.0, -0.0, 0.0, 0.0, 0.0, -1.0]
📐 Enhanced affine matrix created:
   Spacing: 0.545 x 0.597 x 374.767 mm
   Orientation: [1.0, -0.0, 0.0, 0.0, 0.0, -1.0]
   Origin: [-265.0, 0.0, 50.0]
    💾 Successfully created: 06_SCOUT.nii.gz
    📊 Final volume: (1009, 888, 2)
    📏 Data range: [-996, 3065]
    💾 File size: 1.5 MB
    📊 Quality Report Generated:
       Data range: [-996.0, 3065.0]
       Mean: -37.5 ± 316.6
       Voxel spacing: 0.55 x 0.60 x 374.77 mm
       Volume size: 550.4 x 530.0 x 749.5 mm
🔄 Overwriting existing directory: /home/hpadmin/NV/outputs/nifti/PA00000058

Processing: PA00000058
----------
Saving NIFTI files into directory /home/hpadmin/NV/outputs/nifti/PA00000058
📊 Found 775 valid DICOM files
🔍 Detected 7 different series

  Processing series 1/7: 1.25 mm_Series4_6.12  PREOP AAA STENT GRAFT 30% ASIR                     (5/2014_1.250000mm
    Analyzing 359 slices with enhanced quality...
🔧 DICOM rescale parameters:
   Slope: 1.0
   Intercept: -1024.0
   Window Center: 40.0
   Window Width: 400.0
    🔍 Enhanced slice ordering:
       Method: position_z
       Total slices: 359
       Validation: excellent
    ✅ Enhanced processing completed
    📊 Volume specifications:
       Width: 512 pixels
       Height: 512 pixels
       Slices: 359
       Total voxels: 94,109,696
    🔄 Creating 3D volume...
    ✅ Successfully processed 359/359 slices
    🔧 Optimizing to int16 (-32768 to 32767)
    ℹ️  Current data type is already optimal
   DEBUG: ImageOrientationPatient: [1.0, 0.0, 0.0, 0.0, 1.0, 0.0]
📐 Enhanced affine matrix created:
   Spacing: 0.898 x 0.898 x 1.250 mm
   Orientation: [1.0, 0.0, 0.0, 0.0, 1.0, 0.0]
   Origin: [-230.0, -230.0, -472.8]
    💾 Successfully created: 01_1.25_mm.nii.gz
    📊 Final volume: (512, 512, 359)
    📏 Data range: [-2051, 1544]
    💾 File size: 94.6 MB
    📊 Quality Report Generated:
       Data range: [-2051.0, 1544.0]
       Mean: -818.4 ± 778.8
       Voxel spacing: 0.90 x 0.90 x 1.25 mm
       Volume size: 460.0 x 460.0 x 448.8 mm

  Processing series 2/7: 2.5 mm STD - 30% ASIR_Series2_6.12  PREOP AAA STENT GRAFT 30% ASIR                     (5/2014_2.500000mm
    Analyzing 180 slices with enhanced quality...
🔧 DICOM rescale parameters:
   Slope: 1.0
   Intercept: -1024.0
   Window Center: 40.0
   Window Width: 400.0
    🔍 Enhanced slice ordering:
       Method: position_z
       Total slices: 180
       Validation: excellent
    ✅ Enhanced processing completed
    📊 Volume specifications:
       Width: 512 pixels
       Height: 512 pixels
       Slices: 180
       Total voxels: 47,185,920
    🔄 Creating 3D volume...
    ✅ Successfully processed 180/180 slices
    🔧 Optimizing to int16 (-32768 to 32767)
    ℹ️  Current data type is already optimal
   DEBUG: ImageOrientationPatient: [1.0, 0.0, 0.0, 0.0, 1.0, 0.0]
📐 Enhanced affine matrix created:
   Spacing: 0.898 x 0.898 x 2.500 mm
   Orientation: [1.0, 0.0, 0.0, 0.0, 1.0, 0.0]
   Origin: [-230.0, -230.0, -472.8]
    💾 Successfully created: 02_2.5_mm_STD___30%_ASIR.nii.gz
    📊 Final volume: (512, 512, 180)
    📏 Data range: [-2051, 1504]
    💾 File size: 45.7 MB
    📊 Quality Report Generated:
       Data range: [-2051.0, 1504.0]
       Mean: -818.7 ± 778.2
       Voxel spacing: 0.90 x 0.90 x 2.50 mm
       Volume size: 460.0 x 460.0 x 450.0 mm

  Processing series 3/7: SCOUT_Series1_6.12  PREOP AAA STENT GRAFT 30% ASIR                     (5/2014_600.636369mm
    Analyzing 2 slices with enhanced quality...
🔧 DICOM rescale parameters:
   Slope: 1.0
   Intercept: -1024.0
   Window Center: 50.0
   Window Width: 500.0
    🔍 Enhanced slice ordering:
       Method: position_z
       Total slices: 2
       Validation: excellent
    ✅ Enhanced processing completed
    📊 Volume specifications:
       Width: 888 pixels
       Height: 1101 pixels
       Slices: 2
       Total voxels: 1,955,376
    🔄 Creating 3D volume...
    ✅ Successfully processed 2/2 slices
    🔧 Optimizing to int16 (-32768 to 32767)
    ℹ️  Current data type is already optimal
   DEBUG: ImageOrientationPatient: [0.0, -1.0, 0.0, 0.0, 0.0, -1.0]
📐 Enhanced affine matrix created:
   Spacing: 0.545 x 0.597 x 374.767 mm
   Orientation: [0.0, -1.0, 0.0, 0.0, 0.0, -1.0]
   Origin: [-0.0, 265.0, 0.0]
    💾 Successfully created: 03_SCOUT.nii.gz
    📊 Final volume: (1101, 888, 2)
    📏 Data range: [-459, 1158]
    💾 File size: 1.9 MB
    📊 Quality Report Generated:
       Data range: [-459.0, 1158.0]
       Mean: 16.7 ± 297.6
       Voxel spacing: 0.55 x 0.60 x 374.77 mm
       Volume size: 600.5 x 530.0 x 749.5 mm

  Processing series 4/7: cor 1  3mm_Series601_6.12  PREOP AAA STENT GRAFT 30% ASIR                     (5/2014_0.625000mm
    Analyzing 1 slices with enhanced quality...
🔧 DICOM rescale parameters:
   Slope: 1.0
   Intercept: -1024.0
   Window Center: 40.0
   Window Width: 400.0
    🔍 Enhanced slice ordering:
       Method: position_z
       Total slices: 1
       Validation: insufficient_slices
       ⚠️  Less than 2 slices found
    ✅ Enhanced processing completed
    📊 Volume specifications:
       Width: 512 pixels
       Height: 512 pixels
       Slices: 1
       Total voxels: 262,144
    🔄 Creating 3D volume...
    ✅ Successfully processed 1/1 slices
    🔧 Optimizing to int16 (-32768 to 32767)
    ℹ️  Current data type is already optimal
   DEBUG: ImageOrientationPatient: [1.0, 0.0, 0.0, 0.0, 1.0, 0.0]
📐 Enhanced affine matrix created:
   Spacing: 0.898 x 0.898 x 0.625 mm
   Orientation: [1.0, 0.0, 0.0, 0.0, 1.0, 0.0]
   Origin: [-230.0, -230.0, -249.0]
    💾 Successfully created: 04_cor_1__3mm.nii.gz
    📊 Final volume: (512, 512, 1)
    📏 Data range: [-1029, 3076]
    💾 File size: 0.3 MB
    📊 Quality Report Generated:
       Data range: [-1029.0, 3076.0]
       Mean: -239.2 ± 1204.6
       Voxel spacing: 0.90 x 0.90 x 0.62 mm
       Volume size: 460.0 x 460.0 x 0.6 mm

  Processing series 5/7: cor 1  3mm_Series601_6.12  PREOP AAA STENT GRAFT 30% ASIR                     (5/2014_3.000000mm
    Analyzing 102 slices with enhanced quality...
🔧 DICOM rescale parameters:
   Slope: 1.0
   Intercept: -1024.0
   Window Center: 40.0
   Window Width: 400.0
    🔍 Enhanced slice ordering:
       Method: position_z
       Total slices: 102
       Validation: excellent
    ✅ Enhanced processing completed
    📊 Volume specifications:
       Width: 512 pixels
       Height: 512 pixels
       Slices: 102
       Total voxels: 26,738,688
    🔄 Creating 3D volume...
    ✅ Successfully processed 102/102 slices
    🔧 Optimizing to int16 (-32768 to 32767)
    ℹ️  Current data type is already optimal
   DEBUG: ImageOrientationPatient: [1.0, 0.0, 0.0, 0.0, 0.0, -1.0]
📐 Enhanced affine matrix created:
   Spacing: 0.898 x 0.898 x 0.386 mm
   Orientation: [1.0, 0.0, 0.0, 0.0, 0.0, -1.0]
   Origin: [-234.9, -9.9, -19.0]
    💾 Successfully created: 05_cor_1__3mm.nii.gz
    📊 Final volume: (512, 512, 102)
    📏 Data range: [-1026, 1472]
    💾 File size: 26.6 MB
    📊 Quality Report Generated:
       Data range: [-1026.0, 1472.0]
       Mean: -422.5 ± 501.8
       Voxel spacing: 0.90 x 0.90 x 0.39 mm
       Volume size: 460.0 x 460.0 x 39.4 mm

  Processing series 6/7: sag 1  3mm_Series602_6.12  PREOP AAA STENT GRAFT 30% ASIR                     (5/2014_0.625000mm
    Analyzing 1 slices with enhanced quality...
🔧 DICOM rescale parameters:
   Slope: 1.0
   Intercept: -1024.0
   Window Center: 40.0
   Window Width: 400.0
    🔍 Enhanced slice ordering:
       Method: position_z
       Total slices: 1
       Validation: insufficient_slices
       ⚠️  Less than 2 slices found
    ✅ Enhanced processing completed
    📊 Volume specifications:
       Width: 512 pixels
       Height: 512 pixels
       Slices: 1
       Total voxels: 262,144
    🔄 Creating 3D volume...
    ✅ Successfully processed 1/1 slices
    🔧 Optimizing to int16 (-32768 to 32767)
    ℹ️  Current data type is already optimal
   DEBUG: ImageOrientationPatient: [1.0, 0.0, 0.0, 0.0, 1.0, 0.0]
📐 Enhanced affine matrix created:
   Spacing: 0.898 x 0.898 x 0.625 mm
   Orientation: [1.0, 0.0, 0.0, 0.0, 1.0, 0.0]
   Origin: [-230.0, -230.0, -249.0]
    💾 Successfully created: 06_sag_1__3mm.nii.gz
    📊 Final volume: (512, 512, 1)
    📏 Data range: [-1034, 3080]
    💾 File size: 0.3 MB
    📊 Quality Report Generated:
       Data range: [-1034.0, 3080.0]
       Mean: -150.4 ± 1293.4
       Voxel spacing: 0.90 x 0.90 x 0.62 mm
       Volume size: 460.0 x 460.0 x 0.6 mm

  Processing series 7/7: sag 1  3mm_Series602_6.12  PREOP AAA STENT GRAFT 30% ASIR                     (5/2014_3.000000mm
    Analyzing 130 slices with enhanced quality...
🔧 DICOM rescale parameters:
   Slope: 1.0
   Intercept: -1024.0
   Window Center: 40.0
   Window Width: 400.0
    🔍 Enhanced slice ordering:
       Method: position_z
       Total slices: 130
       Validation: excellent
    ✅ Enhanced processing completed
    📊 Volume specifications:
       Width: 512 pixels
       Height: 512 pixels
       Slices: 130
       Total voxels: 34,078,720
    🔄 Creating 3D volume...
    ✅ Successfully processed 130/130 slices
    🔧 Optimizing to int16 (-32768 to 32767)
    ℹ️  Current data type is already optimal
   DEBUG: ImageOrientationPatient: [0.0, 1.0, 0.0, 0.0, 0.0, -1.0]
📐 Enhanced affine matrix created:
   Spacing: 0.898 x 0.898 x 0.070 mm
   Orientation: [0.0, 1.0, 0.0, 0.0, 0.0, -1.0]
   Origin: [80.6, -208.4, -19.0]
    💾 Successfully created: 07_sag_1__3mm.nii.gz
    📊 Final volume: (512, 512, 130)
    📏 Data range: [-1026, 1446]
    💾 File size: 31.1 MB
    📊 Quality Report Generated:
       Data range: [-1026.0, 1446.0]
       Mean: -539.6 ± 503.3
       Voxel spacing: 0.90 x 0.90 x 0.07 mm
       Volume size: 460.0 x 460.0 x 9.1 mm
🔄 Overwriting existing directory: /home/hpadmin/NV/outputs/nifti/PA00000014

Processing: PA00000014
----------
Saving NIFTI files into directory /home/hpadmin/NV/outputs/nifti/PA00000014
📊 Found 1607 valid DICOM files
🔍 Detected 10 different series

  Processing series 1/10: ARTERIAL 1.25MM_Series102_6.14 PRE OP AAA STENT GRAFT  WITH IV CONTRAST_0.625000mm
    Analyzing 775 slices with enhanced quality...
🔧 DICOM rescale parameters:
   Slope: 1.0
   Intercept: -1024.0
   Window Center: 40.0
   Window Width: 400.0
    🔍 Enhanced slice ordering:
       Method: position_z
       Total slices: 775
       Validation: excellent
    ✅ Enhanced processing completed
    📊 Volume specifications:
       Width: 512 pixels
       Height: 512 pixels
       Slices: 775
       Total voxels: 203,161,600
    🔄 Creating 3D volume...
    ✅ Successfully processed 775/775 slices
    🔧 Optimizing to int16 (-32768 to 32767)
    ℹ️  Current data type is already optimal
   DEBUG: ImageOrientationPatient: [1.0, 0.0, 0.0, 0.0, 1.0, 0.0]
📐 Enhanced affine matrix created:
   Spacing: 0.879 x 0.879 x 0.625 mm
   Orientation: [1.0, 0.0, 0.0, 0.0, 1.0, 0.0]
   Origin: [-231.0, -225.0, -470.2]
    💾 Successfully created: 01_ARTERIAL_1.25MM.nii.gz
    📊 Final volume: (512, 512, 775)
    📏 Data range: [-2051, 2161]
    💾 File size: 217.7 MB
    📊 Quality Report Generated:
       Data range: [-2051.0, 2161.0]
       Mean: -799.0 ± 781.3
       Voxel spacing: 0.88 x 0.88 x 0.62 mm
       Volume size: 450.0 x 450.0 x 484.4 mm

  Processing series 2/10: ARTERIAL 1.25MM_Series2_6.14 PRE OP AAA STENT GRAFT  WITH IV CONTRAST_1.250000mm
    Analyzing 387 slices with enhanced quality...
🔧 DICOM rescale parameters:
   Slope: 1.0
   Intercept: -1024.0
   Window Center: 40.0
   Window Width: 400.0
    🔍 Enhanced slice ordering:
       Method: position_z
       Total slices: 387
       Validation: excellent
    ✅ Enhanced processing completed
    📊 Volume specifications:
       Width: 512 pixels
       Height: 512 pixels
       Slices: 387
       Total voxels: 101,449,728
    🔄 Creating 3D volume...
    ✅ Successfully processed 387/387 slices
    🔧 Optimizing to int16 (-32768 to 32767)
    ℹ️  Current data type is already optimal
   DEBUG: ImageOrientationPatient: [1.0, 0.0, 0.0, 0.0, 1.0, 0.0]
📐 Enhanced affine matrix created:
   Spacing: 0.879 x 0.879 x 1.250 mm
   Orientation: [1.0, 0.0, 0.0, 0.0, 1.0, 0.0]
   Origin: [-231.0, -225.0, -469.0]
    💾 Successfully created: 02_ARTERIAL_1.25MM.nii.gz
    📊 Final volume: (512, 512, 387)
    📏 Data range: [-2051, 2150]
    💾 File size: 107.2 MB
    📊 Quality Report Generated:
       Data range: [-2051.0, 2150.0]
       Mean: -799.1 ± 781.0
       Voxel spacing: 0.88 x 0.88 x 1.25 mm
       Volume size: 450.0 x 450.0 x 483.8 mm

  Processing series 3/10: ARTERIAL 2.5MM_Series3_6.14 PRE OP AAA STENT GRAFT  WITH IV CONTRAST_2.500000mm
    Analyzing 194 slices with enhanced quality...
🔧 DICOM rescale parameters:
   Slope: 1.0
   Intercept: -1024.0
   Window Center: 40.0
   Window Width: 400.0
    🔍 Enhanced slice ordering:
       Method: position_z
       Total slices: 194
       Validation: excellent
    ✅ Enhanced processing completed
    📊 Volume specifications:
       Width: 512 pixels
       Height: 512 pixels
       Slices: 194
       Total voxels: 50,855,936
    🔄 Creating 3D volume...
    ✅ Successfully processed 194/194 slices
    🔧 Optimizing to int16 (-32768 to 32767)
    ℹ️  Current data type is already optimal
   DEBUG: ImageOrientationPatient: [1.0, 0.0, 0.0, 0.0, 1.0, 0.0]
📐 Enhanced affine matrix created:
   Spacing: 0.879 x 0.879 x 2.500 mm
   Orientation: [1.0, 0.0, 0.0, 0.0, 1.0, 0.0]
   Origin: [-231.0, -225.0, -469.0]
    💾 Successfully created: 03_ARTERIAL_2.5MM.nii.gz
    📊 Final volume: (512, 512, 194)
    📏 Data range: [-2051, 2094]
    💾 File size: 52.4 MB
    📊 Quality Report Generated:
       Data range: [-2051.0, 2094.0]
       Mean: -799.4 ± 780.4
       Voxel spacing: 0.88 x 0.88 x 2.50 mm
       Volume size: 450.0 x 450.0 x 485.0 mm

  Processing series 4/10: Processed Images_Series256_6.14 PRE OP AAA STENT GRAFT  WITH IV CONTRAST_0.8789060116mm
    Analyzing 1 slices with enhanced quality...
🔧 DICOM rescale parameters:
   Slope: 1.0
   Intercept: -1024.0
   Window Center: 49.0
   Window Width: 406.0
    🔍 Enhanced slice ordering:
       Method: position_z
       Total slices: 1
       Validation: insufficient_slices
       ⚠️  Less than 2 slices found
    ✅ Enhanced processing completed
    📊 Volume specifications:
       Width: 512 pixels
       Height: 512 pixels
       Slices: 1
       Total voxels: 262,144
    🔄 Creating 3D volume...
    ✅ Successfully processed 1/1 slices
    🔧 Optimizing to int16 (-32768 to 32767)
    ℹ️  Current data type is already optimal
   DEBUG: ImageOrientationPatient: [0.9900607467, -9.390023479e-06, 0.1406402439, 0.05497518554, 0.9204620719, -0.3869460225]
📐 Enhanced affine matrix created:
   Spacing: 0.508 x 0.508 x 0.879 mm
   Orientation: [0.9900607467, -9.390023479e-06, 0.1406402439, 0.05497518554, 0.9204620719, -0.3869460225]
   Origin: [-156.7, -115.8, -183.5]
    💾 Successfully created: 04_Processed_Images.nii.gz
    📊 Final volume: (512, 512, 1)
    📏 Data range: [-1019, 3073]
    💾 File size: 0.3 MB
    📊 Quality Report Generated:
       Data range: [-1019.0, 3073.0]
       Mean: 6.8 ± 288.0
       Voxel spacing: 0.51 x 0.51 x 0.88 mm
       Volume size: 260.0 x 260.0 x 0.9 mm

  Processing series 5/10: Reformatted_Series201_6.14 PRE OP AAA STENT GRAFT  WITH IV CONTRAST_1.25mm
    Analyzing 1 slices with enhanced quality...
🔧 DICOM rescale parameters:
   Slope: 1.0
   Intercept: -1024.0
   Window Center: 40.0
   Window Width: 400.0
    🔍 Enhanced slice ordering:
       Method: position_z
       Total slices: 1
       Validation: insufficient_slices
       ⚠️  Less than 2 slices found
    ✅ Enhanced processing completed
    📊 Volume specifications:
       Width: 512 pixels
       Height: 512 pixels
       Slices: 1
       Total voxels: 262,144
    🔄 Creating 3D volume...
    ✅ Successfully processed 1/1 slices
    🔧 Optimizing to int16 (-32768 to 32767)
    ℹ️  Current data type is already optimal
   DEBUG: ImageOrientationPatient: [1.0, 0.0, 0.0, 0.0, 1.0, 0.0]
📐 Enhanced affine matrix created:
   Spacing: 0.879 x 0.879 x 1.250 mm
   Orientation: [1.0, 0.0, 0.0, 0.0, 1.0, 0.0]
   Origin: [-231.0, -225.0, -227.8]
    💾 Successfully created: 05_Reformatted.nii.gz
    📊 Final volume: (512, 512, 1)
    📏 Data range: [-1026, 3074]
    💾 File size: 0.3 MB
    📊 Quality Report Generated:
       Data range: [-1026.0, 3074.0]
       Mean: -436.2 ± 921.1
       Voxel spacing: 0.88 x 0.88 x 1.25 mm
       Volume size: 450.0 x 450.0 x 1.2 mm

  Processing series 6/10: Reformatted_Series201_6.14 PRE OP AAA STENT GRAFT  WITH IV CONTRAST_2.999999762mm
    Analyzing 115 slices with enhanced quality...
🔧 DICOM rescale parameters:
   Slope: 1.0
   Intercept: -1024.0
   Window Center: 40.0
   Window Width: 400.0
    🔍 Enhanced slice ordering:
       Method: position_z
       Total slices: 115
       Validation: excellent
    ✅ Enhanced processing completed
    📊 Volume specifications:
       Width: 512 pixels
       Height: 512 pixels
       Slices: 115
       Total voxels: 30,146,560
    🔄 Creating 3D volume...
    ✅ Successfully processed 115/115 slices
    🔧 Optimizing to int16 (-32768 to 32767)
    ℹ️  Current data type is already optimal
   DEBUG: ImageOrientationPatient: [1.0, 0.0, 0.0, 0.0, 0.0, -1.0]
📐 Enhanced affine matrix created:
   Spacing: 0.967 x 0.967 x 2.553 mm
   Orientation: [1.0, 0.0, 0.0, 0.0, 0.0, -1.0]
   Origin: [-255.9, 131.3, 19.9]
    💾 Successfully created: 06_Reformatted.nii.gz
    📊 Final volume: (512, 512, 115)
    📏 Data range: [-1026, 1818]
    💾 File size: 27.9 MB
    📊 Quality Report Generated:
       Data range: [-1026.0, 1818.0]
       Mean: -524.6 ± 498.0
       Voxel spacing: 0.97 x 0.97 x 2.55 mm
       Volume size: 495.4 x 495.4 x 293.6 mm

  Processing series 7/10: Reformatted_Series202_6.14 PRE OP AAA STENT GRAFT  WITH IV CONTRAST_1.25mm
    Analyzing 1 slices with enhanced quality...
🔧 DICOM rescale parameters:
   Slope: 1.0
   Intercept: -1024.0
   Window Center: 40.0
   Window Width: 400.0
    🔍 Enhanced slice ordering:
       Method: position_z
       Total slices: 1
       Validation: insufficient_slices
       ⚠️  Less than 2 slices found
    ✅ Enhanced processing completed
    📊 Volume specifications:
       Width: 512 pixels
       Height: 512 pixels
       Slices: 1
       Total voxels: 262,144
    🔄 Creating 3D volume...
    ✅ Successfully processed 1/1 slices
    🔧 Optimizing to int16 (-32768 to 32767)
    ℹ️  Current data type is already optimal
   DEBUG: ImageOrientationPatient: [1.0, 0.0, 0.0, 0.0, 1.0, 0.0]
📐 Enhanced affine matrix created:
   Spacing: 0.879 x 0.879 x 1.250 mm
   Orientation: [1.0, 0.0, 0.0, 0.0, 1.0, 0.0]
   Origin: [-231.0, -225.0, -227.8]
    💾 Successfully created: 07_Reformatted.nii.gz
    📊 Final volume: (512, 512, 1)
    📏 Data range: [-1029, 3078]
    💾 File size: 0.3 MB
    📊 Quality Report Generated:
       Data range: [-1029.0, 3078.0]
       Mean: -432.0 ± 946.1
       Voxel spacing: 0.88 x 0.88 x 1.25 mm
       Volume size: 450.0 x 450.0 x 1.2 mm

  Processing series 8/10: Reformatted_Series202_6.14 PRE OP AAA STENT GRAFT  WITH IV CONTRAST_2.999999762mm
    Analyzing 126 slices with enhanced quality...
🔧 DICOM rescale parameters:
   Slope: 1.0
   Intercept: -1024.0
   Window Center: 40.0
   Window Width: 400.0
    🔍 Enhanced slice ordering:
       Method: position_z
       Total slices: 126
       Validation: excellent
    ✅ Enhanced processing completed
    📊 Volume specifications:
       Width: 512 pixels
       Height: 512 pixels
       Slices: 126
       Total voxels: 33,030,144
    🔄 Creating 3D volume...
    ✅ Successfully processed 126/126 slices
    🔧 Optimizing to int16 (-32768 to 32767)
    ℹ️  Current data type is already optimal
   DEBUG: ImageOrientationPatient: [0.004694813397, 0.9999889731, 0.0, 0.0, 0.0, -1.0]
📐 Enhanced affine matrix created:
   Spacing: 0.967 x 0.967 x 0.048 mm
   Orientation: [0.004694813397, 0.9999889731, 0.0, 0.0, 0.0, -1.0]
   Origin: [-133.3, -242.2, 19.9]
    💾 Successfully created: 08_Reformatted.nii.gz
    📊 Final volume: (512, 512, 126)
    📏 Data range: [-1026, 1926]
    💾 File size: 29.2 MB
    📊 Quality Report Generated:
       Data range: [-1026.0, 1926.0]
       Mean: -564.1 ± 493.2
       Voxel spacing: 0.97 x 0.97 x 0.05 mm
       Volume size: 495.4 x 495.4 x 6.0 mm

  Processing series 9/10: SCOUTS_Series1_6.14 PRE OP AAA STENT GRAFT  WITH IV CONTRAST_550.181824mm
    Analyzing 2 slices with enhanced quality...
🔧 DICOM rescale parameters:
   Slope: 1.0
   Intercept: -1024.0
   Window Center: 50.0
   Window Width: 500.0
    🔍 Enhanced slice ordering:
       Method: position_z
       Total slices: 2
       Validation: excellent
    ✅ Enhanced processing completed
    📊 Volume specifications:
       Width: 888 pixels
       Height: 1008 pixels
       Slices: 2
       Total voxels: 1,790,208
    🔄 Creating 3D volume...
    ✅ Successfully processed 2/2 slices
    🔧 Optimizing to int16 (-32768 to 32767)
    ℹ️  Current data type is already optimal
   DEBUG: ImageOrientationPatient: [1.0, -0.0, 0.0, 0.0, 0.0, -1.0]
📐 Enhanced affine matrix created:
   Spacing: 0.545 x 0.597 x 374.767 mm
   Orientation: [1.0, -0.0, 0.0, 0.0, 0.0, -1.0]
   Origin: [-265.0, 0.0, 50.0]
    💾 Successfully created: 09_SCOUTS.nii.gz
    📊 Final volume: (1008, 888, 2)
    📏 Data range: [-616, 1069]
    💾 File size: 1.8 MB
    📊 Quality Report Generated:
       Data range: [-616.0, 1069.0]
       Mean: -83.9 ± 299.4
       Voxel spacing: 0.55 x 0.60 x 374.77 mm
       Volume size: 549.8 x 530.0 x 749.5 mm

  Processing series 10/10: Smart Prep Series_Series200_6.14 PRE OP AAA STENT GRAFT  WITH IV CONTRAST_10.000000mm
    Analyzing 5 slices with enhanced quality...
🔧 DICOM rescale parameters:
   Slope: 1.0
   Intercept: -1024.0
   Window Center: 40.0
   Window Width: 400.0
    🔍 Enhanced slice ordering:
       Method: position_z
       Total slices: 5
       Validation: excellent
    ✅ Enhanced processing completed
    📊 Volume specifications:
       Width: 512 pixels
       Height: 512 pixels
       Slices: 5
       Total voxels: 1,310,720
    🔄 Creating 3D volume...
    ✅ Successfully processed 5/5 slices
    🔧 Optimizing to int16 (-32768 to 32767)
    ℹ️  Current data type is already optimal
   DEBUG: ImageOrientationPatient: [1.0, 0.0, 0.0, 0.0, 1.0, 0.0]
📐 Enhanced affine matrix created:
   Spacing: 0.879 x 0.879 x 10.000 mm
   Orientation: [1.0, 0.0, 0.0, 0.0, 1.0, 0.0]
   Origin: [-231.0, -225.0, -148.2]
    💾 Successfully created: 10_Smart_Prep_Series.nii.gz
    📊 Final volume: (512, 512, 5)
    📏 Data range: [-2050, 1155]
    💾 File size: 1.3 MB
    📊 Quality Report Generated:
       Data range: [-2050.0, 1155.0]
       Mean: -781.1 ± 774.5
       Voxel spacing: 0.88 x 0.88 x 10.00 mm
       Volume size: 450.0 x 450.0 x 50.0 mm
🔄 Overwriting existing directory: /home/hpadmin/NV/outputs/nifti/PA00000050

Processing: PA00000050
----------
Saving NIFTI files into directory /home/hpadmin/NV/outputs/nifti/PA00000050
📊 Found 407 valid DICOM files
🔍 Detected 6 different series

  Processing series 1/6: ARTERIAL PHASE 2.5MM_Series3_6.14  PREOP AAA WITH CONTRAST_2.500000mm
    Analyzing 188 slices with enhanced quality...
🔧 DICOM rescale parameters:
   Slope: 1.0
   Intercept: -1024.0
   Window Center: 40.0
   Window Width: 400.0
    🔍 Enhanced slice ordering:
       Method: position_z
       Total slices: 188
       Validation: excellent
    ✅ Enhanced processing completed
    📊 Volume specifications:
       Width: 512 pixels
       Height: 512 pixels
       Slices: 188
       Total voxels: 49,283,072
    🔄 Creating 3D volume...
    ✅ Successfully processed 188/188 slices
    🔧 Optimizing to int16 (-32768 to 32767)
    ℹ️  Current data type is already optimal
   DEBUG: ImageOrientationPatient: [1.0, 0.0, 0.0, 0.0, 1.0, 0.0]
📐 Enhanced affine matrix created:
   Spacing: 0.703 x 0.703 x 2.500 mm
   Orientation: [1.0, 0.0, 0.0, 0.0, 1.0, 0.0]
   Origin: [-180.0, -175.2, -483.2]
    💾 Successfully created: 01_ARTERIAL_PHASE_2.5MM.nii.gz
    📊 Final volume: (512, 512, 188)
    📏 Data range: [-2051, 1849]
    💾 File size: 52.0 MB
    📊 Quality Report Generated:
       Data range: [-2051.0, 1849.0]
       Mean: -720.1 ± 813.6
       Voxel spacing: 0.70 x 0.70 x 2.50 mm
       Volume size: 360.0 x 360.0 x 470.0 mm

  Processing series 2/6: COR 3_Series601_6.14  PREOP AAA WITH CONTRAST_0.703125mm
    Analyzing 1 slices with enhanced quality...
🔧 DICOM rescale parameters:
   Slope: 1.0
   Intercept: -1024.0
   Window Center: 40.0
   Window Width: 400.0
    🔍 Enhanced slice ordering:
       Method: position_z
       Total slices: 1
       Validation: insufficient_slices
       ⚠️  Less than 2 slices found
    ✅ Enhanced processing completed
    📊 Volume specifications:
       Width: 512 pixels
       Height: 512 pixels
       Slices: 1
       Total voxels: 262,144
    🔄 Creating 3D volume...
    ✅ Successfully processed 1/1 slices
    🔧 Optimizing to int16 (-32768 to 32767)
    ℹ️  Current data type is already optimal
   DEBUG: ImageOrientationPatient: [0.0, 1.0, 0.0, 0.0, 0.0, -1.0]
📐 Enhanced affine matrix created:
   Spacing: 0.913 x 0.913 x 0.703 mm
   Orientation: [0.0, 1.0, 0.0, 0.0, 0.0, -1.0]
   Origin: [-0.0, -228.9, -16.1]
    💾 Successfully created: 02_COR_3.nii.gz
    📊 Final volume: (512, 512, 1)
    📏 Data range: [-1028, 3076]
    💾 File size: 0.2 MB
    📊 Quality Report Generated:
       Data range: [-1028.0, 3076.0]
       Mean: -166.6 ± 1164.2
       Voxel spacing: 0.91 x 0.91 x 0.70 mm
       Volume size: 467.5 x 467.5 x 0.7 mm

  Processing series 3/6: COR 3_Series601_6.14  PREOP AAA WITH CONTRAST_3.000000mm
    Analyzing 95 slices with enhanced quality...
🔧 DICOM rescale parameters:
   Slope: 1.0
   Intercept: -1024.0
   Window Center: 40.0
   Window Width: 400.0
    🔍 Enhanced slice ordering:
       Method: position_z
       Total slices: 95
       Validation: excellent
    ✅ Enhanced processing completed
    📊 Volume specifications:
       Width: 512 pixels
       Height: 512 pixels
       Slices: 95
       Total voxels: 24,903,680
    🔄 Creating 3D volume...
    ✅ Successfully processed 95/95 slices
    🔧 Optimizing to int16 (-32768 to 32767)
    ℹ️  Current data type is already optimal
   DEBUG: ImageOrientationPatient: [1.0, 0.0, 0.0, 0.0, 0.0, -1.0]
📐 Enhanced affine matrix created:
   Spacing: 0.913 x 0.913 x 0.511 mm
   Orientation: [1.0, 0.0, 0.0, 0.0, 0.0, -1.0]
   Origin: [-233.8, 21.9, -15.8]
    💾 Successfully created: 03_COR_3.nii.gz
    📊 Final volume: (512, 512, 95)
    📏 Data range: [-1026, 1560]
    💾 File size: 20.4 MB
    📊 Quality Report Generated:
       Data range: [-1026.0, 1560.0]
       Mean: -527.6 ± 510.1
       Voxel spacing: 0.91 x 0.91 x 0.51 mm
       Volume size: 467.5 x 467.5 x 48.5 mm

  Processing series 4/6: SAG 3_Series602_6.14  PREOP AAA WITH CONTRAST_0.703125mm
    Analyzing 1 slices with enhanced quality...
🔧 DICOM rescale parameters:
   Slope: 1.0
   Intercept: -1024.0
   Window Center: 40.0
   Window Width: 400.0
    🔍 Enhanced slice ordering:
       Method: position_z
       Total slices: 1
       Validation: insufficient_slices
       ⚠️  Less than 2 slices found
    ✅ Enhanced processing completed
    📊 Volume specifications:
       Width: 512 pixels
       Height: 512 pixels
       Slices: 1
       Total voxels: 262,144
    🔄 Creating 3D volume...
    ✅ Successfully processed 1/1 slices
    🔧 Optimizing to int16 (-32768 to 32767)
    ℹ️  Current data type is already optimal
   DEBUG: ImageOrientationPatient: [1.0, 0.0, 0.0, 0.0, 0.0, -1.0]
📐 Enhanced affine matrix created:
   Spacing: 0.913 x 0.913 x 0.703 mm
   Orientation: [1.0, 0.0, 0.0, 0.0, 0.0, -1.0]
   Origin: [-233.8, 12.9, -16.1]
    💾 Successfully created: 04_SAG_3.nii.gz
    📊 Final volume: (512, 512, 1)
    📏 Data range: [-1040, 3090]
    💾 File size: 0.3 MB
    📊 Quality Report Generated:
       Data range: [-1040.0, 3090.0]
       Mean: 66.8 ± 1206.4
       Voxel spacing: 0.91 x 0.91 x 0.70 mm
       Volume size: 467.5 x 467.5 x 0.7 mm

  Processing series 5/6: SAG 3_Series602_6.14  PREOP AAA WITH CONTRAST_3.000000mm
    Analyzing 120 slices with enhanced quality...
🔧 DICOM rescale parameters:
   Slope: 1.0
   Intercept: -1024.0
   Window Center: 40.0
   Window Width: 400.0
    🔍 Enhanced slice ordering:
       Method: position_z
       Total slices: 120
       Validation: excellent
    ✅ Enhanced processing completed
    📊 Volume specifications:
       Width: 512 pixels
       Height: 512 pixels
       Slices: 120
       Total voxels: 31,457,280
    🔄 Creating 3D volume...
    ✅ Successfully processed 120/120 slices
    🔧 Optimizing to int16 (-32768 to 32767)
    ℹ️  Current data type is already optimal
   DEBUG: ImageOrientationPatient: [0.0, 1.0, 0.0, 0.010352, 0.0, -0.999946]
📐 Enhanced affine matrix created:
   Spacing: 0.920 x 0.920 x 3.000 mm
   Orientation: [0.0, 1.0, 0.0, 0.010352, 0.0, -0.999946]
   Origin: [-180.9, -222.7, -15.8]
    💾 Successfully created: 05_SAG_3.nii.gz
    📊 Final volume: (512, 512, 120)
    📏 Data range: [-1026, 1600]
    💾 File size: 22.6 MB
    📊 Quality Report Generated:
       Data range: [-1026.0, 1600.0]
       Mean: -629.5 ± 494.3
       Voxel spacing: 0.92 x 0.92 x 3.00 mm
       Volume size: 471.2 x 471.2 x 360.0 mm

  Processing series 6/6: SCOUT_Series1_6.14  PREOP AAA WITH CONTRAST_560.545427mm
    Analyzing 2 slices with enhanced quality...
🔧 DICOM rescale parameters:
   Slope: 1.0
   Intercept: -1024.0
   Window Center: 50.0
   Window Width: 500.0
    🔍 Enhanced slice ordering:
       Method: position_z
       Total slices: 2
       Validation: excellent
    ✅ Enhanced processing completed
    📊 Volume specifications:
       Width: 888 pixels
       Height: 1027 pixels
       Slices: 2
       Total voxels: 1,823,952
    🔄 Creating 3D volume...
    ✅ Successfully processed 2/2 slices
    🔧 Optimizing to int16 (-32768 to 32767)
    ℹ️  Current data type is already optimal
   DEBUG: ImageOrientationPatient: [0.0, -1.0, 0.0, 0.0, 0.0, -1.0]
📐 Enhanced affine matrix created:
   Spacing: 0.545 x 0.597 x 374.767 mm
   Orientation: [0.0, -1.0, 0.0, 0.0, 0.0, -1.0]
   Origin: [-0.0, 265.0, 60.0]
    💾 Successfully created: 06_SCOUT.nii.gz
    📊 Final volume: (1027, 888, 2)
    📏 Data range: [-523, 1142]
    💾 File size: 1.7 MB
    📊 Quality Report Generated:
       Data range: [-523.0, 1142.0]
       Mean: -70.6 ± 278.0
       Voxel spacing: 0.55 x 0.60 x 374.77 mm
       Volume size: 560.2 x 530.0 x 749.5 mm
🔄 Overwriting existing directory: /home/hpadmin/NV/outputs/nifti/PA00000015

Processing: PA00000015
----------
Saving NIFTI files into directory /home/hpadmin/NV/outputs/nifti/PA00000015
📊 Found 488 valid DICOM files
🔍 Detected 7 different series

  Processing series 1/7: SCOUT_Series1_6.13  DISSECTION/PREOP AAA STENT GRAFT REGIONAL 64_550.545488mm
    Analyzing 2 slices with enhanced quality...
🔧 DICOM rescale parameters:
   Slope: 1.0
   Intercept: -1024.0
   Window Center: 50.0
   Window Width: 500.0
    🔍 Enhanced slice ordering:
       Method: position_z
       Total slices: 2
       Validation: excellent
    ✅ Enhanced processing completed
    📊 Volume specifications:
       Width: 888 pixels
       Height: 1009 pixels
       Slices: 2
       Total voxels: 1,791,984
    🔄 Creating 3D volume...
    ✅ Successfully processed 2/2 slices
    🔧 Optimizing to int16 (-32768 to 32767)
    ℹ️  Current data type is already optimal
   DEBUG: ImageOrientationPatient: [1.0, 0.0, 0.0, 0.0, 0.0, -1.0]
📐 Enhanced affine matrix created:
   Spacing: 0.545 x 0.597 x 374.767 mm
   Orientation: [1.0, 0.0, 0.0, 0.0, 0.0, -1.0]
   Origin: [-265.0, -0.0, 50.0]
    💾 Successfully created: 01_SCOUT.nii.gz
    📊 Final volume: (1009, 888, 2)
    📏 Data range: [-498, 3070]
    💾 File size: 1.8 MB
    📊 Quality Report Generated:
       Data range: [-498.0, 3070.0]
       Mean: 59.1 ± 301.4
       Voxel spacing: 0.55 x 0.60 x 374.77 mm
       Volume size: 550.4 x 530.0 x 749.5 mm

  Processing series 2/7: ax 25x25_Series601_6.13  DISSECTION/PREOP AAA STENT GRAFT REGIONAL 64_0.976562mm
    Analyzing 1 slices with enhanced quality...
🔧 DICOM rescale parameters:
   Slope: 1.0
   Intercept: -1024.0
   Window Center: 40.0
   Window Width: 400.0
    🔍 Enhanced slice ordering:
       Method: position_z
       Total slices: 1
       Validation: insufficient_slices
       ⚠️  Less than 2 slices found
    ✅ Enhanced processing completed
    📊 Volume specifications:
       Width: 512 pixels
       Height: 512 pixels
       Slices: 1
       Total voxels: 262,144
    🔄 Creating 3D volume...
    ✅ Successfully processed 1/1 slices
    🔧 Optimizing to int16 (-32768 to 32767)
    ℹ️  Current data type is already optimal
   DEBUG: ImageOrientationPatient: [1.0, 0.0, 0.0, 0.0, 0.0, -1.0]
📐 Enhanced affine matrix created:
   Spacing: 0.977 x 0.977 x 0.977 mm
   Orientation: [1.0, 0.0, 0.0, 0.0, 0.0, -1.0]
   Origin: [-250.0, 19.9, 32.2]
    💾 Successfully created: 02_ax_25x25.nii.gz
    📊 Final volume: (512, 512, 1)
    📏 Data range: [-1041, 3090]
    💾 File size: 0.3 MB
    📊 Quality Report Generated:
       Data range: [-1041.0, 3090.0]
       Mean: 438.4 ± 1351.3
       Voxel spacing: 0.98 x 0.98 x 0.98 mm
       Volume size: 500.0 x 500.0 x 1.0 mm

  Processing series 3/7: ax 25x25_Series601_6.13  DISSECTION/PREOP AAA STENT GRAFT REGIONAL 64_2.500000mm
    Analyzing 200 slices with enhanced quality...
🔧 DICOM rescale parameters:
   Slope: 1.0
   Intercept: -1024.0
   Window Center: 40.0
   Window Width: 400.0
    🔍 Enhanced slice ordering:
       Method: position_z
       Total slices: 200
       Validation: excellent
    ✅ Enhanced processing completed
    📊 Volume specifications:
       Width: 512 pixels
       Height: 512 pixels
       Slices: 200
       Total voxels: 52,428,800
    🔄 Creating 3D volume...
    ✅ Successfully processed 200/200 slices
    🔧 Optimizing to int16 (-32768 to 32767)
    ℹ️  Current data type is already optimal
   DEBUG: ImageOrientationPatient: [1.0, 0.0, 0.0, 0.0, 1.0, 0.0]
📐 Enhanced affine matrix created:
   Spacing: 0.977 x 0.977 x 2.500 mm
   Orientation: [1.0, 0.0, 0.0, 0.0, 1.0, 0.0]
   Origin: [-242.7, -230.1, -466.2]
    💾 Successfully created: 03_ax_25x25.nii.gz
    📊 Final volume: (512, 512, 200)
    📏 Data range: [-1027, 1471]
    💾 File size: 49.7 MB
    📊 Quality Report Generated:
       Data range: [-1027.0, 1471.0]
       Mean: -618.5 ± 476.0
       Voxel spacing: 0.98 x 0.98 x 2.50 mm
       Volume size: 500.0 x 500.0 x 500.0 mm

  Processing series 4/7: cor 3x3_Series602_6.13  DISSECTION/PREOP AAA STENT GRAFT REGIONAL 64_0.976562mm
    Analyzing 1 slices with enhanced quality...
🔧 DICOM rescale parameters:
   Slope: 1.0
   Intercept: -1024.0
   Window Center: 40.0
   Window Width: 400.0
    🔍 Enhanced slice ordering:
       Method: position_z
       Total slices: 1
       Validation: insufficient_slices
       ⚠️  Less than 2 slices found
    ✅ Enhanced processing completed
    📊 Volume specifications:
       Width: 512 pixels
       Height: 512 pixels
       Slices: 1
       Total voxels: 262,144
    🔄 Creating 3D volume...
    ✅ Successfully processed 1/1 slices
    🔧 Optimizing to int16 (-32768 to 32767)
    ℹ️  Current data type is already optimal
   DEBUG: ImageOrientationPatient: [0.0, 1.0, 0.0, 0.0, 0.0, -1.0]
📐 Enhanced affine matrix created:
   Spacing: 0.977 x 0.977 x 0.977 mm
   Orientation: [0.0, 1.0, 0.0, 0.0, 0.0, -1.0]
   Origin: [7.3, -254.5, 32.2]
    💾 Successfully created: 04_cor_3x3.nii.gz
    📊 Final volume: (512, 512, 1)
    📏 Data range: [-1030, 3080]
    💾 File size: 0.3 MB
    📊 Quality Report Generated:
       Data range: [-1030.0, 3080.0]
       Mean: 18.5 ± 1252.5
       Voxel spacing: 0.98 x 0.98 x 0.98 mm
       Volume size: 500.0 x 500.0 x 1.0 mm

  Processing series 5/7: cor 3x3_Series602_6.13  DISSECTION/PREOP AAA STENT GRAFT REGIONAL 64_3.000000mm
    Analyzing 127 slices with enhanced quality...
🔧 DICOM rescale parameters:
   Slope: 1.0
   Intercept: -1024.0
   Window Center: 40.0
   Window Width: 400.0
    🔍 Enhanced slice ordering:
       Method: position_z
       Total slices: 127
       Validation: excellent
    ✅ Enhanced processing completed
    📊 Volume specifications:
       Width: 512 pixels
       Height: 512 pixels
       Slices: 127
       Total voxels: 33,292,288
    🔄 Creating 3D volume...
    ✅ Successfully processed 127/127 slices
    🔧 Optimizing to int16 (-32768 to 32767)
    ℹ️  Current data type is already optimal
   DEBUG: ImageOrientationPatient: [1.0, 0.0, 0.0, 0.0, 0.0, -1.0]
📐 Enhanced affine matrix created:
   Spacing: 0.977 x 0.977 x 0.214 mm
   Orientation: [1.0, 0.0, 0.0, 0.0, 0.0, -1.0]
   Origin: [-242.7, -46.1, 32.5]
    💾 Successfully created: 05_cor_3x3.nii.gz
    📊 Final volume: (512, 512, 127)
    📏 Data range: [-1026, 1436]
    💾 File size: 31.3 MB
    📊 Quality Report Generated:
       Data range: [-1026.0, 1436.0]
       Mean: -499.4 ± 479.6
       Voxel spacing: 0.98 x 0.98 x 0.21 mm
       Volume size: 500.0 x 500.0 x 27.2 mm

  Processing series 6/7: sag 3x3_Series603_6.13  DISSECTION/PREOP AAA STENT GRAFT REGIONAL 64_0.976562mm
    Analyzing 1 slices with enhanced quality...
🔧 DICOM rescale parameters:
   Slope: 1.0
   Intercept: -1024.0
   Window Center: 40.0
   Window Width: 400.0
    🔍 Enhanced slice ordering:
       Method: position_z
       Total slices: 1
       Validation: insufficient_slices
       ⚠️  Less than 2 slices found
    ✅ Enhanced processing completed
    📊 Volume specifications:
       Width: 512 pixels
       Height: 512 pixels
       Slices: 1
       Total voxels: 262,144
    🔄 Creating 3D volume...
    ✅ Successfully processed 1/1 slices
    🔧 Optimizing to int16 (-32768 to 32767)
    ℹ️  Current data type is already optimal
   DEBUG: ImageOrientationPatient: [1.0, 0.0, 0.0, 0.0, 0.0, -1.0]
📐 Enhanced affine matrix created:
   Spacing: 0.977 x 0.977 x 0.977 mm
   Orientation: [1.0, 0.0, 0.0, 0.0, 0.0, -1.0]
   Origin: [-250.0, 19.9, 32.2]
    💾 Successfully created: 06_sag_3x3.nii.gz
    📊 Final volume: (512, 512, 1)
    📏 Data range: [-1047, 3090]
    💾 File size: 0.3 MB
    📊 Quality Report Generated:
       Data range: [-1047.0, 3090.0]
       Mean: 306.0 ± 1251.8
       Voxel spacing: 0.98 x 0.98 x 0.98 mm
       Volume size: 500.0 x 500.0 x 1.0 mm

  Processing series 7/7: sag 3x3_Series603_6.13  DISSECTION/PREOP AAA STENT GRAFT REGIONAL 64_3.000000mm
    Analyzing 156 slices with enhanced quality...
🔧 DICOM rescale parameters:
   Slope: 1.0
   Intercept: -1024.0
   Window Center: 40.0
   Window Width: 400.0
    🔍 Enhanced slice ordering:
       Method: position_z
       Total slices: 156
       Validation: excellent
    ✅ Enhanced processing completed
    📊 Volume specifications:
       Width: 512 pixels
       Height: 512 pixels
       Slices: 156
       Total voxels: 40,894,464
    🔄 Creating 3D volume...
    ✅ Successfully processed 156/156 slices
    🔧 Optimizing to int16 (-32768 to 32767)
    ℹ️  Current data type is already optimal
   DEBUG: ImageOrientationPatient: [0.0, 1.0, 0.0, 0.0, 0.0, -1.0]
📐 Enhanced affine matrix created:
   Spacing: 0.977 x 0.977 x 0.271 mm
   Orientation: [0.0, 1.0, 0.0, 0.0, 0.0, -1.0]
   Origin: [104.8, -230.1, 32.5]
    💾 Successfully created: 07_sag_3x3.nii.gz
    📊 Final volume: (512, 512, 156)
    📏 Data range: [-1026, 1446]
    💾 File size: 35.4 MB
    📊 Quality Report Generated:
       Data range: [-1026.0, 1446.0]
       Mean: -594.4 ± 478.5
       Voxel spacing: 0.98 x 0.98 x 0.27 mm
       Volume size: 500.0 x 500.0 x 42.3 mm
--------------------------------------------------
🎉 DICOM to NIFTI conversion completed with enhanced quality!
✓ Successfully converted: 5 directories
✗ Failed conversions: 0 directories
📁 Total processed: 5 directories

🔬 Quality Improvements Applied:
   • Enhanced affine matrix with proper DICOM orientation
   • DICOM rescale parameters for optimal data values
   • Advanced slice ordering with multiple criteria
   • Slice consistency validation and gap detection
   • Data type optimization for storage efficiency
   • Comprehensive quality reports for each series
   • Spatial accuracy preservation
